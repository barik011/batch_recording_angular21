<!-- MAIN -->
<div class="container-fluid py-4">

  <div class="page-header d-flex justify-content-between align-items-center">
    <h4 class="mb-0">
      <i class="fa-solid fa-link me-2"></i> Enrollment Management
    </h4>
    <div class="d-flex gap-2">
      <button class="btn btn-light btn-icon" (click)="onToggleView()" [title]="toggleView ?'Card View':'Table View'">
        <i class="fa-solid " [ngClass]="toggleView ?'fa-grip':'fa-table'"></i>
      </button>
      <button class="btn btn-warning" (click)="openModal()">
        <i class="fa-solid fa-plus me-1"></i> Add Enrollment
      </button>
    </div>
  </div>
  @if(!toggleView){
  <!-- TABLE VIEW -->
  <table class="table table-hover bg-white shadow-sm rounded align-middle">
    <thead class="table-primary">
      <tr>
        <th>Sl No</th>
        <th>Batch Name</th>
        <th>Name Candidate</th>
        <th>Enrollment Date</th>
        <th>Status</th>
        <th class="text-center">Action</th>
      </tr>
    </thead>
    <tbody>
      @for (item of batchEnrollmentList(); track $index) {
      <tr>
        <td>{{$index +1}}</td>
        <td>{{item.batchName}}</td>
        <td>{{item.fullName}}</td>
        <td>{{item.enrollmentDate}}</td>
        <td><span class="badge" [ngClass]="item.isActive?'bg-success':'bg-warning'">{{item.isActive}}</span></td>
        <td class="text-center action-icons">
          <i class="fa-solid fa-pen text-primary" (click)="onEditEnrollment(item.enrollmentId)"></i>
          <i class="fa-solid fa-trash text-danger"></i>
        </td>
      </tr>}
    </tbody>
  </table>
  }
  @else {
  <!-- CARD VIEW -->
  <div class="row mt-4">
    <div class="col-md-4">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5>Angular Batch 2026</h5>
          <p class="mb-1"><strong>Candidate:</strong> John Doe</p>
          <p class="mb-1"><strong>Enrollment Date:</strong> 10-01-2026</p>
          <span class="badge bg-success">Active</span>
        </div>
        <div class="card-footer bg-white text-end action-icons">
          <i class="fa-solid fa-pen text-primary"></i>
          <i class="fa-solid fa-trash text-danger"></i>
        </div>
      </div>
    </div>
  </div>
  }
</div>

<!-- RIGHT PANEL MODAL -->
<div class="modal right-panel" #candidateModal>
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <form [formGroup]="newEnrollmentObj">
        <div class="modal-header">
          <h5 class="modal-title">
            <i class="fa-solid fa-link me-2"></i> Enrollment Form
          </h5>
          <button class="btn-close" (click)="closeModal()"></button>
        </div>

        <div class="modal-body">

          <div class="mb-3">
            <label class="form-label">Batch Name</label>
            <select class="form-select"  formControlName="batchId">
              <option>--Select Batch--</option>
              @for (item of batchList(); track $index)
              {
                <option [value]="item.batchId">{{item.batchName}}</option>
              }
              
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label">Candidate Name</label>
            <select class="form-select"  formControlName="candidateId">
              <option>--Select Candidate---</option>
             @for (item of candidateList(); track $index)
              {
                <option [value]="item.candidateId">{{item.fullName}}</option>
              }
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label">Enrollment Date</label>
            <input type="datetime-local" class="form-control" formControlName="enrollmentDate">
          </div>
          <div class="mb-3">
            <div class="form-check form-switch">
              <input type="checkbox" class="form-check-input" name="isActive" formControlName="isActive" />
              <label class="form-check-label" for="isActive">Status</label>
            </div>
          </div>

        </div>

        <div class="modal-footer">
          <button class="btn btn-secondary" (click)="closeModal()">Cancel</button>
          @if (newEnrollmentObj.controls['enrollmentId'].value==0)
          {
          <button type="button" class="btn btn-primary" (click)="onSaveEnrollment()">
            <i class="fa-solid fa-floppy-disk me-1"></i> Save
          </button>
          }
          @else {
          <button type="button" class="btn btn-warning">
            <i class="fa-solid fa-floppy-disk me-1"></i> Update
          </button>
          }

        </div>

      </form>
    </div>

  </div>
</div>